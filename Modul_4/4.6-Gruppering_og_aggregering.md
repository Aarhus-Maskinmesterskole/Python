# ğŸ”„ **4.6 Gruppering og Aggregering i Pandas**  

NÃ¥r vi arbejder med store datasÃ¦t, er det ofte nÃ¸dvendigt at **gruppere og aggregere** data for at fÃ¥ indsigt.  
I dette modul lÃ¦rer du at bruge **`groupby()`**, **`agg()`**, **`pivot tables`** og andre metoder til at **analysere og opsummere data effektivt**.  

> **MÃ¥l for dette modul:**  
> âœ… ForstÃ¥ hvordan `groupby()` bruges til at gruppere data  
> âœ… Aggregere data med `sum()`, `mean()`, `count()` osv.  
> âœ… Oprette pivot-tabeller til bedre dataanalyse  
> âœ… Sammenflette og transformere grupperede data  

---

## ğŸ“Œ **1. Gruppering af data med `groupby()`**  

`groupby()` bruges til at **gruppere rÃ¦kker** baseret pÃ¥ Ã©n eller flere kolonner.  

```python
import pandas as pd

df = pd.read_csv("data.csv")

# GruppÃ©r data efter "By" og beregn gennemsnitsalder
df_grupperet = df.groupby("By")["Alder"].mean()

print(df_grupperet)
```

ğŸ“Œ **Output:**  
```
By
Aarhus       28.4
KÃ¸benhavn    32.1
Odense       27.3
Name: Alder, dtype: float64
```

> **ğŸ“Œ `groupby()` samler data baseret pÃ¥ en kategori og udfÃ¸rer en beregning.**  

### **1.1 GruppÃ©r flere kolonner**  

```python
df_grupperet = df.groupby(["By", "Job"])["Alder"].mean()
print(df_grupperet)
```

> **ğŸ“Œ Du kan gruppere efter flere kolonner for at fÃ¥ mere detaljeret indsigt.**  

---

## ğŸ“Š **2. Aggregere data med `agg()`**  

`agg()` bruges til at **udfÃ¸re flere beregninger pÃ¥ samme tid**.  

```python
df_agg = df.groupby("By").agg({
    "Alder": ["mean", "min", "max"],
    "Indkomst": ["sum"]
})

print(df_agg)
```

ğŸ“Œ **Output:**  
```
             Alder                 Indkomst
              mean min max      sum
By                                     
Aarhus      28.4  22  35    150000
KÃ¸benhavn   32.1  25  40    180000
Odense      27.3  21  32    120000
```

> **ğŸ“Œ `agg()` gÃ¸r det muligt at kombinere flere beregninger i Ã©n kommando.**  

---

## ğŸ”„ **3. Pivot-tabeller i Pandas**  

Pandas **pivot-tabeller** minder om dem i Excel og giver en **fleksibel mÃ¥de at opsummere data pÃ¥**.  

```python
df_pivot = df.pivot_table(values="Indkomst", index="By", columns="Job", aggfunc="mean")
print(df_pivot)
```

> **ğŸ“Œ `pivot_table()` er en kraftfuld metode til at analysere data i flere dimensioner.**  

---

## ğŸ” **4. Sammenfletning af grupperede data**  

Du kan **sammenflette grupperede data** med resten af datasÃ¦ttet.  

```python
df_gruppe = df.groupby("By")["Indkomst"].mean().reset_index()

# Sammenflet med det originale datasÃ¦t
df = df.merge(df_gruppe, on="By", suffixes=("", "_Gennemsnit"))
print(df.head())
```

> **ğŸ“Œ `.reset_index()` konverterer en grupperet tabel tilbage til en DataFrame.**  

---

## ğŸ¯ **5. Ã˜velser**  

### 1ï¸âƒ£ **Gruppering af data**
- GruppÃ©r dit datasÃ¦t efter `"By"` og beregn gennemsnittet af `"Alder"`.  
- GruppÃ©r efter `"Job"` og tÃ¦lle antallet af personer i hver kategori.  

### 2ï¸âƒ£ **Brug af `agg()`**
- Find min-, max- og gennemsnitsvÃ¦rdier for `"Indkomst"`, grupperet efter `"By"`.  

### 3ï¸âƒ£ **Pivot-tabeller**
- Opret en pivot-tabel, hvor `"Job"` er kolonner, `"By"` er rÃ¦kker, og `"Indkomst"` er vÃ¦rdierne.  

### ğŸ”¥ **Bonusudfordring**
- Lav en pivot-tabel, der viser gennemsnitsalderen for hver `"Job"`-kategori i hver `"By"`.  

---

## ğŸš€ **6. Opsummering**  
âœ” **`groupby()` grupperer data efter en eller flere kolonner**  
âœ” **`agg()` udfÃ¸rer flere beregninger pÃ¥ Ã©n gang**  
âœ” **Pivot-tabeller opsummerer komplekse datasÃ¦t**  
âœ” **Sammenfletning af grupperede data gÃ¸r det lettere at analysere**  

**ğŸ“Œ Videre til nÃ¦ste modul: [4.8-Lagring af data](4.8-Lagring_af_data.md)**  

God fornÃ¸jelse med Pandas! ğŸ¼ğŸš€  
